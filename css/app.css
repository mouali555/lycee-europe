/* css/app.css — layout console + chat + avatars + dark éducatif */

:root{
  --panelBorder: rgba(148, 163, 184, 0.35);      /* gris bleuté */
  --panelBorder2: rgba(59, 130, 246, 0.55);      /* bleu accent */
  --bgSoft: #020617;                             /* fond carte principal */
  --bgSoft2: #0b1120;                            /* variant légèrement plus claire */
  --textSoft: rgba(156, 163, 175, 0.9);          /* gris clair */
  --textHard: #e5e7eb;                           /* quasi blanc */

  --accent: #2563eb;                             /* bleu du chat / boutons */
  --accentSoft: rgba(37, 99, 235, 0.18);
  --accentIA: #38bdf8;                           /* bleu IA */
  --accentKey: #facc15;                          /* doré KEYMASTER */
}

/* Top bar */
.topbar{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  padding:10px 12px;
  border-bottom:1px solid rgba(15,23,42,.9);
  background: radial-gradient(circle at top left, #0f172a 0%, #020617 55%, #020617 100%);
  box-shadow:
    0 0 0 1px rgba(15, 23, 42, 0.9),
    0 18px 40px rgba(15, 23, 42, 0.9);
}

.topbar .left{
  display:flex;
  align-items:center;
  gap:10px;
  min-width:0;
}

.topbar .dot{
  width:10px;
  height:10px;
  border-radius:50%;
  background: #22c55e;
  box-shadow: 0 0 12px rgba(34,197,94,.9);
}

.topbar .brand{
  letter-spacing:2px;
  font-weight:700;
  white-space:nowrap;
  color: var(--textHard);
}

.topbar .clock{
  opacity:.8;
  white-space:nowrap;
  color: var(--textSoft);
}

.topbar .right{
  display:flex;
  align-items:center;
  gap:10px;
}

.userTag{
  padding:4px 10px;
  border:1px solid rgba(148,163,184,.6);
  background: rgba(15,23,42,.9);
  border-radius:999px;
  letter-spacing:1px;
  max-width:36vw;
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
  color: var(--textHard);
  transition: background .18s ease, box-shadow .18s ease, transform .08s ease, border-color .18s;
}

.userTag:hover{
  background: rgba(15,23,42,1);
  border-color: var(--accent);
  box-shadow: 0 0 18px rgba(37,99,235,.35);
  transform: translateY(-1px);
}

/* Buttons / Inputs */
.btn{
  border:1px solid var(--panelBorder2);
  background: linear-gradient(to bottom, rgba(30,64,175,.95), rgba(30,64,175,.85));
  color: #f9fafb;
  padding:10px 12px;
  border-radius:999px;
  cursor:pointer;
  letter-spacing:1px;
  font-weight:600;
  font-size:14px;
}

.btn:hover{ filter: brightness(1.06); }
.btn:active{ transform: translateY(1px); }

.btn.danger{
  border-color: rgba(248,113,113,.6);
  background: linear-gradient(to bottom, rgba(127,29,29,.95), rgba(127,29,29,.85));
  box-shadow: 0 0 14px rgba(248,113,113,.35);
}

.input{
  width:100%;
  border:1px solid rgba(31,41,55,.9);
  background: rgba(15,23,42,.95);
  color: var(--textHard);
  padding:10px 12px;
  border-radius:10px;
  outline:none;
  font-size:14px;
}

.input::placeholder{
  color: rgba(148,163,184,.8);
}

.input:focus{
  border-color: var(--accent);
  box-shadow: 0 0 0 1px rgba(37,99,235,.6);
}

.mini{
  opacity:.75;
  font-size:12px;
  letter-spacing:1px;
  color: var(--textSoft);
}

/* Layout */
.layout{
  display:grid;
  grid-template-columns: 320px 1fr;
  gap:12px;
  padding:12px;
  height: calc(100vh - 54px);
  height: calc(100dvh - 54px);
  box-sizing:border-box;
  background: radial-gradient(circle at top, #020617 0%, #020617 40%, #000 100%);
}

/* Sidebar */
.sidebar{
  display:flex;
  flex-direction:column;
  gap:12px;
  min-height:0;
}

.panel{
  border:1px solid rgba(15,23,42,.95);
  background: linear-gradient(to bottom right, var(--bgSoft), var(--bgSoft2));
  border-radius:16px;
  overflow:hidden;
  min-height:0;
  box-shadow: 0 18px 40px rgba(15,23,42,.9);
}

.panelTitle{
  padding:10px 12px;
  border-bottom:1px solid rgba(30,41,59,.9);
  letter-spacing:2px;
  font-weight:700;
  font-size:13px;
  text-transform:uppercase;
  color: var(--textSoft);
}

.panelTitle.row{
  display:flex;
  align-items:center;
  justify-content:space-between;
}

/* Join / invite */
.joinBox{
  padding:10px 12px;
  display:grid;
  gap:8px;
  border-bottom:1px solid rgba(30,41,59,.9);
}

.joinBox .hint{
  font-size:12px;
  opacity:.78;
  line-height:1.3;
  color: var(--textSoft);
}

.list{
  padding:8px;
  display:grid;
  gap:6px;
  overflow:auto;
  max-height: 240px;
}

.item{
  padding:10px 10px;
  border:1px solid rgba(31,41,55,.9);
  background: rgba(15,23,42,.96);
  border-radius:12px;
  cursor:pointer;
  user-select:none;
  color: var(--textHard);
  font-size:13px;
}

.item:hover{ filter:brightness(1.05); }

.item.active{
  border-color: var(--accent);
  background: rgba(37,99,235,.12);
}

/* Chat panel */
.chat{
  border:1px solid rgba(15,23,42,.95);
  border-radius:18px;
  background: linear-gradient(to bottom right, #020617, #020617);
  overflow:hidden;
  min-height:0;
  display:flex;
  flex-direction:column;
  box-shadow: 0 22px 60px rgba(15,23,42,.95);
}

.chatHeader{
  padding:10px 12px;
  border-bottom:1px solid rgba(30,41,59,.9);
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
}

.roomTag{
  display:flex;
  gap:6px;
  align-items:baseline;
  letter-spacing:2px;
  font-weight:700;
  text-transform:uppercase;
  font-size:13px;
  color: var(--textSoft);
}

.statusLine{
  display:flex;
  inline-size:max-content;
  gap:8px;
  align-items:center;
  opacity:.9;
  font-size:13px;
  color: var(--textSoft);
}

/* Messages area */
.messages{
  flex:1;
  min-height:0;
  overflow:auto;
  padding:12px;
  display:flex;
  flex-direction:column;
  gap:10px;
  scroll-behavior: smooth;
}

/* Message row (avatar + bubble) */
.msgRow{
  display:flex;
  gap:10px;
  align-items:flex-start;
  animation: msg-pop 0.18s ease-out;
}

.msgRow.meRow{
  flex-direction:row-reverse;
}

/* Avatars */
.avatar{
  width:34px;
  height:34px;
  border-radius:999px;
  border:1px solid rgba(51,65,85,.95);
  background: rgba(15,23,42,.9);
  flex:0 0 34px;
  object-fit:cover;
  position: relative;
  box-shadow:
    0 0 0 1px rgba(15,23,42,.9),
    0 0 14px rgba(0,0,0,.9);
}

.avatar.fallback{
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:700;
  letter-spacing:1px;
  color: var(--textHard);
}

/* Bubbles */
.bubble{
  max-width: min(680px, 78%);
  border:1px solid rgba(31,41,55,.9);
  background: rgba(15,23,42,.96);
  border-radius:16px;
  padding:8px 10px;
}

.msgRow.meRow .bubble{
  border-color: rgba(37,99,235,.9);
  background: rgba(37,99,235,.22);
}

.meta{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  margin-bottom:4px;
}

.name{
  font-weight:700;
  letter-spacing:0.5px;
  opacity:.92;
  color: var(--textHard);
  font-size:13px;
}

.text{
  white-space:pre-wrap;
  word-break:break-word;
  line-height:1.4;
  color: var(--textHard);
  font-size:14px;
}

/* System line */
.msg.sys{
  opacity:.9;
  font-size:12px;
  letter-spacing:0.5px;
  color: var(--textSoft);
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
}
/* IA / Bot badges */
.badge{
  display:inline-flex;
  align-items:center;
  gap:6px;
  padding:2px 10px;
  border-radius:999px;
  border:1px solid rgba(148,163,184,.6);
  background: rgba(15,23,42,.95);
  font-size:10px;
  letter-spacing:1px;
  font-weight:600;
  text-transform:uppercase;
  color: var(--textSoft);
}

.msgRow.iaRow .bubble{
  border-color: rgba(56,189,248,.9);
  background: rgba(8,47,73,.75);
}

.msgRow.keyRow .bubble{
  border-color: rgba(250,204,21,.9);
  background: rgba(120,53,15,.55);
}

.msgRow.iaRow .name{
  color: var(--accentIA);
}

.msgRow.keyRow .name{
  color: var(--accentKey);
}

/* Boot overlay */
.boot{
  position: fixed;
  inset: 0;
  z-index: 60;
  display:flex;
  align-items:center;
  justify-content:center;
  padding: 18px;
  background: radial-gradient(circle at top, rgba(15,23,42,.95), rgba(15,23,42,.98));
  backdrop-filter: blur(14px);
}

.boot.hidden{ display:none; }

.bootCard{
  width: min(760px, 100%);
  border:1px solid rgba(148,163,184,.7);
  background: rgba(15,23,42,.98);
  border-radius: 20px;
  padding: 16px;
  box-shadow: 0 28px 80px rgba(0,0,0,.95);
}

.bootTitle{
  letter-spacing: 2px;
  font-weight: 900;
  margin-bottom: 12px;
  color: var(--textHard);
}

.bootLines{
  opacity: .9;
  margin-bottom: 14px;
  color: var(--textSoft);
}
.bootLine{ margin-bottom: 8px; }
.bootHint{ margin-top: 10px; }

/* Profile modal */
.modal{
  position: fixed;
  inset: 0;
  z-index: 55;
  display:none;
  align-items:center;
  justify-content:center;
  padding: 18px;
  background: rgba(15,23,42,.92);
}

.modal[aria-hidden="false"]{ display:flex; }

.modalCard{
  width: min(640px, 100%);
  border:1px solid rgba(148,163,184,.7);
  background: rgba(15,23,42,.98);
  border-radius: 20px;
  padding: 14px;
  box-shadow: 0 24px 64px rgba(0,0,0,.95);
}

.modalTop{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap: 10px;
  margin-bottom: 10px;
  color: var(--textHard);
}

.iconBtn{
  border: 1px solid rgba(148,163,184,.7);
  background: rgba(15,23,42,.96);
  color: var(--textHard);
  border-radius: 999px;
  padding: 8px 10px;
  cursor:pointer;
  font-size:13px;
}

.iconBtn:hover{
  border-color: var(--accent);
}

.profileGrid{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
}

.profileItem{
  border:1px solid rgba(30,41,59,.9);
  background: rgba(15,23,42,.96);
  border-radius: 16px;
  padding: 12px;
  color: var(--textSoft);
}

.profileValue{
  font-weight: 900;
  letter-spacing: 1px;
  margin-top: 4px;
  color: var(--textHard);
}

.profileKeys{
  color: var(--textSoft);
  line-height: 1.4;
}

/* Composer (input + send) */
.composer{
  border-top:1px solid rgba(30,41,59,.9);
  padding:10px;
  display:grid;
  grid-template-columns: 1fr auto;
  gap:10px;
  background: rgba(15,23,42,.96);
}

.msgInput{
  min-width:0;
}

/* New message button */
.newMsgBtn{
  position: absolute;
  right: 18px;
  bottom: 88px;
  z-index: 5;
  border-radius: 999px;
  padding: 8px 12px;
  border: 1px solid rgba(148,163,184,.8);
  background: rgba(15,23,42,.98);
  color: var(--textHard);
  backdrop-filter: blur(10px);
  box-shadow: 0 18px 40px rgba(0,0,0,.85);
  font-size: 12px;
  letter-spacing: 1px;
}

/* Animations douces messages */

@keyframes msg-pop{
  from{
    transform: translateY(4px);
    opacity: 0;
  }
  to{
    transform: translateY(0);
    opacity: 1;
  }
}

/* HUD : barre d’XP animée */
#hudXpFill{
  transition: width .25s ease-out;
}

/* ✅ MOBILE FIX */
@media (max-width: 940px){
  .layout{
    grid-template-columns: 1fr;
    height: calc(100dvh - 54px);
  }

  .sidebar{
    order:2;
  }

  .chat{
    order:1;
    height: min(62dvh, 620px);
  }

  .list{
    max-height: 180px;
  }

  .bubble{
    max-width: 82%;
  }

  .userTag{
    max-width: 44vw;
  }
}

/* ✅ SMALL MOBILE (very small screens) */
@media (max-width: 520px){
  .topbar .clock{ display:none; }

  .chat{
    height: 60dvh;
  }

  .avatar{
    width:30px;
    height:30px;
    flex:0 0 30px;
  }

  .panel{
    border-radius:14px;
  }
}
